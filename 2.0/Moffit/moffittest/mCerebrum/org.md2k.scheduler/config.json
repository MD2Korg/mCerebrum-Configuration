{
  "id": "mofitt",
  "type": "STUDY",
  "title": "Mofitt Study",
  "summary": "Mofitt Study",
  "create_datasource": [
    {
      "type": "EMA",
      "id": "RANDOM"
    },
    {
      "type": "EMI",
      "id": "LOW_STRESS"
    },
    {
      "type": "EMI",
      "id": "HIGH_STRESS"
    },
    {
      "type": "EMI",
      "id": "LAPSE"
    },
    {
      "type": "EMI",
      "id": "NO_LAPSE"
    },
    {
      "type": "LOG"
    }
  ],
  "listen": {
    "sources": [
      {
        "type": "DAY",
        "id": "START"
      },
      {
        "type": "DAY",
        "id": "END"
      },
      {
        "type": "DAY_TYPE",
        "id": "PRE_QUIT"
      },
      {
        "type": "DAY_TYPE",
        "id": "POST_QUIT"
      },
      {
        "type": "ORG_MD2K_CSTRESS_STRESS_EPISODE_CLASSIFICATION"
      }
    ]
  },
  "schedulers": [
    {
      "id": "Random",
      "type": "EMA",
      "title": "Random EMA",
      "summary": "Random EMA",
      "listen": [
        {
          "type": "DAY",
          "id": "START"
        },
        {
          "type": "DAY",
          "id": "END"
        }
      ],
      "condition": "is_active_day(now()) == TRUE",
      "when": {
        "base": "get_sample(dt=DAY,di=START)",
        "offset":[
          {
            "start":"time(00:00:00)",
            "end":"time(04:00:00)"
          },
          {
            "start":"time(04:00:00)",
            "end":"time(08:00:00)"
          },
          {
            "start":"time(08:00:00)",
            "end":"time(12:00:00)"
          }
        ],
        "condition": "get_sample(dt=EMA,di=RANDOM)>now()-time(01:00:00) && get_sample(dt=EMI)>now()-time(00:15:00)",
        "repeat": "24:00:00",
        "rules": [
          {
            "type": "IMMEDIATE",
            "retry": "00:01:00"
          }
        ]
      },
      "what": [
        [
          {
            "condition": "(WEEK1==TRUE && TUESDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact2.1.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK1==TRUE && SATURDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact2.2.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK2==TRUE && WEDNESDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact4.2.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK2==TRUE && FRIDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact4.3.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK3==TRUE && THURSDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact3.2.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK4==TRUE && MONDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact5.1.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK4==TRUE && SUNDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact5.5.1.1"
                }
              ]
            }
          }
        ]
      ]
    },
    {
      "id": "730pm",
      "type": "EMA",
      "title": "EMA at 7:30pm",
      "summary": "Trigger EMA at 7:30pm",
      "condition": "valid_study == TRUE",
      "when": {
        "search_by_value": "time(19:30:00)",
        "blocks": [
          "00:00:00 - 02:00:00"
        ],
        "condition": "ema_triggered_at_least_120_minutes_ago==TRUE",
        "repeat": "24:00:00",
        "rules": [
          {
            "type": "IMMEDIATE",
            "retry": "00:01:00"
          }
        ]
      },
      "what": [
        [
          {
            "condition": "(WEEK2==TRUE && MONDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact4.1.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK2==TRUE && SUNDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact4.4.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK3==TRUE && TUESDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact3.1.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK3==TRUE && SATURDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact3.3.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK4==TRUE && WEDNESDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact5.2.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK4==TRUE && THURSDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact5.3.1.1"
                }
              ]
            }
          },
          {
            "condition": "(WEEK4==TRUE && FRIDAY==TRUE)",
            "act": {
              "id": "action_notification_ema",
              "parameters": [
                {
                  "id": "application",
                  "value": "contact5.4.1.1"
                }
              ]
            }
          }
        ]
      ]
    }
  ],
  "actions": [
    {
      "id": "action_notification_ema",
      "start_state": "notification_ok_cancel",
      "transitions": [
        {
          "current_state": "notification_ok_cancel",
          "input": "ok",
          "next_state": "application"
        },
        {
          "current_state": "notification_ok_cancel",
          "input": "cancel",
          "next_state": "save_notification_cancel"
        },
        {
          "current_state": "notification_ok_cancel",
          "input": "timeout",
          "next_state": "save_notification_timeout"
        },
        {
          "current_state": "application",
          "input": "completed",
          "next_state": "save_ema"
        },
        {
          "current_state": "application",
          "input": "missed",
          "next_state": "save_ema"
        },
        {
          "current_state": "application",
          "input": "abandoned_by_timeout",
          "next_state": "save_ema"
        },
        {
          "current_state": "application",
          "input": "abandoned_by_user",
          "next_state": "save_ema"
        }
      ]
    },
    {
      "id": "action_notification_reminder_delay_ema_incentive",
      "start_state": "notification",
      "transitions": [
        {
          "current_state": "notification",
          "input": "ok",
          "next_state": "application"
        },
        {
          "current_state": "notification",
          "input": "cancel",
          "next_state": "save_notification_cancel"
        },
        {
          "current_state": "notification",
          "input": "delay",
          "next_state": "notification_delay"
        },
        {
          "current_state": "notification",
          "input": "timeout",
          "next_state": "save_notification_timeout"
        },
        {
          "current_state": "notification_delay",
          "input": "ok",
          "next_state": "application"
        },
        {
          "current_state": "notification_delay",
          "input": "cancel",
          "next_state": "save_notification_cancel"
        },
        {
          "current_state": "notification_delay",
          "input": "timeout",
          "next_state": "save_notification_timeout"
        },
        {
          "current_state": "application",
          "input": "completed",
          "next_state": "save_ema"
        },
        {
          "current_state": "application",
          "input": "missed",
          "next_state": "save_ema"
        },
        {
          "current_state": "application",
          "input": "abandoned",
          "next_state": "save_ema"
        },
        {
          "current_state": "application",
          "input": "timeout",
          "next_state": "save_ema"
        },
        {
          "current_state": "incentive",
          "input": "ok",
          "next_state": "close"
        },
        {
          "current_state": "incentive",
          "input": "timeout",
          "next_state": "close"
        }
      ]
    }
  ],
  "tasks": [
    {
      "id": "notification",
      "type": "NOTIFICATION",
      "notifications": [
        {
          "type": "PHONE_VIBRATION",
          "format": "3_500ms",
          "repeat": 3,
          "interval": "00:00:03",
          "when": [
            "00:00:00",
            "00:00:20",
            "00:00:40"
          ]
        },
        {
          "type": "PHONE_MESSAGE",
          "format": "dialog",
          "repeat": 1,
          "interval": "00:00:30",
          "when": [
            "00:00:00"
          ],
          "message": {
            "title": "Survey",
            "message": "Time to take a survey",
            "buttons": [
              {
                "id": "ok",
                "title": "Ok"
              },
              {
                "id": "cancel",
                "title": "Cancel",
                "confirm": true
              },
              {
                "id": "delay_10",
                "title": "Delay 10 minutes"
              }
            ]
          }
        },
        {
          "type": "PHONE_TONE",
          "format": "tone.mp3",
          "repeat": 3,
          "interval": "00:00:03",
          "when": [
            "00:00:00",
            "00:00:20",
            "00:00:40"
          ]
        },
        {
          "type": "PHONE_SCREEN",
          "repeat": 1,
          "interval": "00:00:5",
          "when": [
            "00:00:00",
            "00:00:20",
            "00:00:40"
          ]
        }
      ]
    },
    {
      "id": "notification_ok_cancel",
      "type": "NOTIFICATION",
      "notifications": [
        {
          "type": "PHONE_VIBRATION",
          "format": "3_500ms",
          "repeat": 1,
          "interval": "00:00:01",
          "when": [
            "00:00:00",
            "00:30:00",
            "01:00:00"
          ]
        },
        {
          "type": "PHONE_MESSAGE",
          "format": "dialog",
          "repeat": 1,
          "interval": "01:30:00",
          "when": [
            "00:00:00"
          ],
          "message": {
            "title": "Survey",
            "message": "Time to take a survey",
            "buttons": [
              {
                "id": "ok",
                "title": "Ok"
              },
              {
                "id": "cancel",
                "title": "Cancel",
                "confirm": true
              }
            ]
          }
        },
        {
          "type": "PHONE_TONE",
          "format": "tone.mp3",
          "repeat": 1,
          "interval": "00:00:01",
          "when": [
            "00:00:00",
            "00:30:00",
            "01:00:00"
          ]
        },
        {
          "type": "PHONE_SCREEN",
          "repeat": 1,
          "interval": "00:00:10",
          "when": [
            "00:00:00",
            "00:30:00",
            "01:00:00"
          ]
        }
      ]
    },
    {
      "id": "contact2.1.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.1.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact2.1.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.1.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact2.1.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.1.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact2.1.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.1.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact2.2.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.2.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact2.2.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.2.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact2.2.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.2.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact2.2.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact2.2.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.1.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.1.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.1.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.1.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.1.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.1.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.1.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.1.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.2.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.2.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.2.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.2.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.2.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.2.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.2.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.2.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.3.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.3.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.3.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.3.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.3.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.3.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact3.3.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact3.3.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.1.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.1.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.1.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.1.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.1.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.1.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.1.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.1.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.2.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.2.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.2.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.2.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.2.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.2.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.2.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.2.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.3.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.3.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.3.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.3.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.3.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.3.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.3.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.3.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.4.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.4.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.4.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.4.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.4.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.4.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact4.4.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact4.4.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.1.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.1.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.1.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.1.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.1.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.1.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.1.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.1.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.2.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.2.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.2.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.2.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.2.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.2.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.2.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.2.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.3.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.3.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.3.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.3.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.3.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.3.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.3.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.3.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.4.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.4.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.4.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.4.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.4.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.4.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.4.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.4.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.5.1.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.5.1.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.5.1.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.5.1.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.5.2.1",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.5.2.1.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "contact5.5.2.2",
      "type": "ema",
      "applications": [
        {
          "id": "org.md2k.ema",
          "type": "EMA",
          "parameters": [
            "contact5.5.2.2.json"
          ],
          "timeout": "00:30:00"
        }
      ]
    },
    {
      "id": "incentive",
      "type": "incentive",
      "incentives": [
        {
          "incentive": 1.25,
          "data_source": {
            "type": "incentive"
          },
          "messages": [
            "Thank you. You will be paid $1.25 for taking the survey and wearing the sensors for more than 60% of the time since your last survey.",
            "You will be paid $1.25",
            "Total Earning: $"
          ]
        },
        {
          "incentive": 0.50,
          "data_source": {
            "type": "incentive"
          },
          "messages": [
            "Thank you. Unfortunately, you will only be paid $0.50 because you have not worn the sensors for at least 60% of the time since your last survey.",
            "You will be paid $0.50",
            "Total Earning: $"
          ]
        }
      ]
    },
    {
      "id": "save_notification_cancel",
      "type": "save",
      "save": [
        {
          "data_source": {
            "type": "EMA"
          },
          "data": {
            "type": "string",
            "string": "CANCELLED_BY_USER_AT_NOTIFICATION"
          }
        }
      ]
    },
    {
      "id": "save_notification_timeout",
      "type": "save",
      "save": [
        {
          "data_source": {
            "type": "EMA"
          },
          "data": {
            "type": "string",
            "string": "ABANDONED_BY_TIMEOUT_AT_NOTIFICATION"
          }
        }
      ]
    },
    {
      "id": "save_ema",
      "type": "save",
      "save": [
        {
          "data_source": {
            "type": "EMA"
          },
          "data": {
            "type": "json"
          }
        }
      ]
    }
  ],
  "conditions": [
    {
      "id": "phone_battery_greater_or_equal_10",
      "type": "__PHONE_BATTERY_PERCENTAGE__",
      "title": "Phone Battery Percentage>=10",
      "summary": "Phone battery percentage is greater than or equal 10",
      "condition": "get_last_sample(BATTERY,null,null,null,null,null,null,org.md2k.phonesensor,0)>=10"
    },
    {
      "id": "not_active_last_1_minute",
      "type": "__NOT_ACTIVE__",
      "title": "Not physically active in last 1 minute",
      "summary": "Not physically active in last 1 minute",
      "input": [
        {
          "input": "current_activity_record",
          "search_by_time": {
            "source": {
              "application": {
                "id": "org.md2k.streamprocessor"
              },
              "type": "STRESS_ACTIVITY"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:01:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "true",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "percentage",
          "search_by_value": "66.6"
        },
        {
          "input": "compare_with",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "current_activity_record",
          "operator": "==",
          "input2": "compare_with",
          "output": "comparison"
        },
        {
          "input1": "comparison",
          "operator": "count",
          "output": "not_active"
        },
        {
          "input1": "current_activity_record",
          "operator": "count",
          "output": "total_sample"
        },
        {
          "input1": "not_active",
          "operator": "percentage",
          "input2": "total_sample",
          "output": "not_active_percentage"
        },
        {
          "input1": "not_active_percentage",
          "operator": ">=",
          "input2": "percentage",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "not_active_last_5_minutes",
      "type": "__NOT_ACTIVE__",
      "title": "Not physically active in last 5 minutes",
      "summary": "Not physically active in last 5 minutes",
      "input": [
        {
          "input": "current_activity_record",
          "search_by_time": {
            "source": {
              "application": {
                "id": "org.md2k.streamprocessor"
              },
              "type": "STRESS_ACTIVITY"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:05:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "true",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "percentage",
          "search_by_value": "66.6"
        },
        {
          "input": "compare_with",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "current_activity_record",
          "operator": "==",
          "input2": "compare_with",
          "output": "comparison"
        },
        {
          "input1": "comparison",
          "operator": "count",
          "output": "not_active"
        },
        {
          "input1": "current_activity_record",
          "operator": "count",
          "output": "total_sample"
        },
        {
          "input1": "not_active",
          "operator": "percentage",
          "input2": "total_sample",
          "output": "not_active_percentage"
        },
        {
          "input1": "not_active_percentage",
          "operator": ">=",
          "input2": "percentage",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "not_driving_last_5_minutes",
      "type": "__NOT_DRIVING__",
      "title": "Not driving in last 5 minutes",
      "summary": "Not driving in last 5 minutes",
      "input": [
        {
          "input": "current_driving_record",
          "search_by_time": {
            "source": {
              "application": {
                "id": "org.md2k.phonesensor"
              },
              "type": "ACTIVITY_TYPE"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:05:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "true",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "percentage",
          "search_by_value": "66.6"
        },
        {
          "input": "compare_with",
          "search_by_value": "6"
        }
      ],
      "process": [
        {
          "input1": "current_driving_record",
          "operator": "!=",
          "input2": "compare_with",
          "output": "comparison"
        },
        {
          "input1": "comparison",
          "operator": "count",
          "output": "not_driving"
        },
        {
          "input1": "current_driving_record",
          "operator": "count",
          "output": "total_sample"
        },
        {
          "input1": "not_driving",
          "operator": "percentage",
          "input2": "total_sample",
          "output": "not_driving_percentage"
        },
        {
          "input1": "not_driving_percentage",
          "operator": ">=",
          "input2": "percentage",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "ema_triggered_at_least_120_minutes_ago",
      "type": "__EMA_TRIGGER_TIME__",
      "title": "EMA triggered at least 120 minutes ago",
      "summary": "EMA triggered at least 120 minutes ago",
      "condition":"count_sample(EMA,null,null,null,null,null,null,null,now()-time(02:00:00), now())<1"
    },
    {
      "id": "random_ema_triggered_at_least_60_minutes_ago",
      "type": "__RANDOM_EMA_TRIGGER_TIME__",
      "title": "Random EMA triggered at least 60 minutes ago",
      "summary": "Random EMA triggered at least 60 minutes ago",
      "condition":"count_sample(EMA,RANDOM,null,null,null,null,null,null,now()-time(01:00:00), now())<1"
    },
    {
      "id": "random_ema_triggered_at_least_10_minutes_ago",
      "type": "__RANDOM_EMA_TRIGGER_TIME__",
      "title": "Random EMA triggered at least 10 minutes ago",
      "summary": "Random EMA triggered at least 10 minutes ago",
      "condition":"count_sample(EMA,RANDOM,null,null,null,null,null,null,now()-time(00:10:00), now())<1"
    },
    {
      "id": "random_ema_triggered_at_least_5_minutes_ago",
      "type": "__RANDOM_EMA_TRIGGER_TIME__",
      "title": "Random EMA triggered at least 5 minutes ago",
      "summary": "Random EMA triggered at least 5 minutes ago",
      "condition":"count_sample(EMA,RANDOM,null,null,null,null,null,null,now()-time(00:05:00), now())<1"
    },
    {
      "id": "smoking_ema_triggered_at_least_30_minutes_ago",
      "type": "__SMOKING_EMA_TRIGGER_TIME__",
      "title": "Smoking EMA triggered at least 30 minutes ago",
      "summary": "Smoking EMA triggered at least 30 minutes ago",
      "condition":"count_sample(EMA,SMOKING,null,null,null,null,null,null,now()-time(00:30:00), now())<1"
    },
    {
      "id": "smoking_ema_triggered_at_least_10_minutes_ago",
      "type": "__SMOKING_EMA_TRIGGER_TIME__",
      "title": "Smoking EMA triggered at least 10 minutes ago",
      "summary": "Smoking EMA triggered at least 10 minutes ago",
      "condition":"count_sample(EMA,SMOKING,null,null,null,null,null,null,now()-time(00:10:00), now())<1"
    },
    {
      "id": "smoking_ema_triggered_at_least_5_minutes_ago",
      "type": "__SMOKING_EMA_TRIGGER_TIME__",
      "title": "Smoking EMA triggered at least 5 minutes ago",
      "summary": "Smoking EMA triggered at least 5 minutes ago",
      "condition":"count_sample(EMA,SMOKING,null,null,null,null,null,null,now()-time(00:05:00), now())<1"
    },
    {
      "id": "stress_ema_triggered_at_least_30_minutes_ago",
      "type": "__STRESS_EMA_TRIGGER_TIME__",
      "title": "Stress EMA triggered at least 30 minutes ago",
      "summary": "Stress EMA triggered at least 30 minutes ago",
      "condition":"count_sample(EMA,STRESS,null,null,null,null,null,null,now()-time(00:30:00), now())<1"
    },
    {
      "id": "stress_ema_triggered_at_least_10_minutes_ago",
      "type": "__STRESS_EMA_TRIGGER_TIME__",
      "title": "Stress EMA triggered at least 10 minutes ago",
      "summary": "Stress EMA triggered at least 10 minutes ago",
      "condition":"count_sample(EMA,STRESS,null,null,null,null,null,null,now()-time(00:10:00), now())<1"
    },
    {
      "id": "stress_ema_triggered_at_least_5_minutes_ago",
      "type": "__STRESS_EMA_TRIGGER_TIME__",
      "title": "Stress EMA triggered at least 5 minutes ago",
      "summary": "Stress EMA triggered at least 5 minutes ago",
      "condition":"count_sample(EMA,STRESS,null,null,null,null,null,null,now()-time(00:05:00), now())<1"
    },
    {
      "id": "last_ema_15_minutes_ago",
      "type": "__EMA_TRIGGER_TIME__",
      "title": "Any EMA triggered at least 15 minutes ago",
      "summary": "Any EMA triggered at least 15 minutes ago",
      "condition":"count_sample(EMA,null,null,null,null,null,null,null,now()-time(00:15:00), now())<1"
      },
    {
      "id": "last_ema_5_minutes_ago",
      "type": "__EMA_TRIGGER_TIME__",
      "title": "Any EMA triggered at least 5 minutes ago",
      "summary": "Any EMA triggered at least 5 minutes ago",
      "condition":"count_sample(EMA,null,null,null,null,null,null,null,now()-time(00:30:00), now())<1"
    },
    {
      "id": "last_emi_30_minutes_ago",
      "type": "__EMI_TRIGGER_TIME__",
      "title": "Any EMI triggered at least 30 minutes ago",
      "summary": "Any EMI triggered at least 30 minutes ago",
      "condition":"count_sample(EMI,null,null,null,null,null,null,null,now()-time(00:30:00), now())<1"
    },
    {
      "id": "smoking_emi_60_minutes_ago",
      "type": "__SMOKING_EMI__",
      "title": "Smoking EMI triggered at least 60 minutes ago",
      "summary": "Smoking EMI triggered at least 60 minutes ago",
      "condition":"count_sample(EMI,SMOKING,null,null,null,null,null,null,now()-time(01:00:00), now())<1"
    },
    {
      "id": "WEEK1",
      "type": "__WEEK__",
      "title": "Week 1 of the study",
      "summary": "Week 1 of the study",
      "input": [
        {
          "input": "study_start",
          "search_by_sample": {
            "source": {
              "type": "STUDY_START"
            },
            "sample_no": 1,
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "current_time",
          "search_by_value": "now()"
        },
        {
          "input": "week_start",
          "search_by_value": "time(00:00:00)"
        },
        {
          "input": "week_end",
          "search_by_value": "time(168:00:00)"
        },
        {
          "input": "two",
          "search_by_value": "2"
        }
      ],
      "process": [
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_start",
          "output": "week_start_time"
        },
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_end",
          "output": "week_end_time"
        },
        {
          "input1": "current_time",
          "operator": ">=",
          "input2": "week_start_time",
          "output": "valid_week_start"
        },
        {
          "input1": "current_time",
          "operator": "<=",
          "input2": "week_end_time",
          "output": "valid_week_end"
        },
        {
          "input1": "valid_week_start",
          "operator": "count",
          "output": "is_valid_week_start"
        },
        {
          "input1": "valid_week_end",
          "operator": "count",
          "output": "is_valid_week_end"
        },
        {
          "input1": "is_valid_week_start",
          "operator": "+",
          "input2": "is_valid_week_end",
          "output": "is_valid"
        },
        {
          "input1": "is_valid",
          "operator": "==",
          "input2": "two",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "WEEK2",
      "type": "__WEEK__",
      "title": "Week 2 of the study",
      "summary": "Week 2 of the study",
      "input": [
        {
          "input": "study_start",
          "search_by_sample": {
            "source": {
              "type": "STUDY_START"
            },
            "sample_no": 1,
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "current_time",
          "search_by_value": "now()"
        },
        {
          "input": "week_start",
          "search_by_value": "time(168:00:00)"
        },
        {
          "input": "week_end",
          "search_by_value": "time(336:00:00)"
        },
        {
          "input": "two",
          "search_by_value": "2"
        }
      ],
      "process": [
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_start",
          "output": "week_start_time"
        },
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_end",
          "output": "week_end_time"
        },
        {
          "input1": "current_time",
          "operator": ">=",
          "input2": "week_start_time",
          "output": "valid_week_start"
        },
        {
          "input1": "current_time",
          "operator": "<=",
          "input2": "week_end_time",
          "output": "valid_week_end"
        },
        {
          "input1": "valid_week_start",
          "operator": "count",
          "output": "is_valid_week_start"
        },
        {
          "input1": "valid_week_end",
          "operator": "count",
          "output": "is_valid_week_end"
        },
        {
          "input1": "is_valid_week_start",
          "operator": "+",
          "input2": "is_valid_week_end",
          "output": "is_valid"
        },
        {
          "input1": "is_valid",
          "operator": "==",
          "input2": "two",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "WEEK3",
      "type": "__WEEK__",
      "title": "Week 3 of the study",
      "summary": "Week 3 of the study",
      "input": [
        {
          "input": "study_start",
          "search_by_sample": {
            "source": {
              "type": "STUDY_START"
            },
            "sample_no": 1,
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "current_time",
          "search_by_value": "now()"
        },
        {
          "input": "week_start",
          "search_by_value": "time(336:00:00)"
        },
        {
          "input": "week_end",
          "search_by_value": "time(504:00:00)"
        },
        {
          "input": "two",
          "search_by_value": "2"
        }
      ],
      "process": [
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_start",
          "output": "week_start_time"
        },
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_end",
          "output": "week_end_time"
        },
        {
          "input1": "current_time",
          "operator": ">=",
          "input2": "week_start_time",
          "output": "valid_week_start"
        },
        {
          "input1": "current_time",
          "operator": "<=",
          "input2": "week_end_time",
          "output": "valid_week_end"
        },
        {
          "input1": "valid_week_start",
          "operator": "count",
          "output": "is_valid_week_start"
        },
        {
          "input1": "valid_week_end",
          "operator": "count",
          "output": "is_valid_week_end"
        },
        {
          "input1": "is_valid_week_start",
          "operator": "+",
          "input2": "is_valid_week_end",
          "output": "is_valid"
        },
        {
          "input1": "is_valid",
          "operator": "==",
          "input2": "two",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "WEEK4",
      "type": "__WEEK__",
      "title": "Week 4 of the study",
      "summary": "Week 4 of the study",
      "input": [
        {
          "input": "study_start",
          "search_by_sample": {
            "source": {
              "type": "STUDY_START"
            },
            "sample_no": 1,
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "current_time",
          "search_by_value": "now()"
        },
        {
          "input": "week_start",
          "search_by_value": "time(504:00:00)"
        },
        {
          "input": "week_end",
          "search_by_value": "time(672:00:00)"
        },
        {
          "input": "two",
          "search_by_value": "2"
        }
      ],
      "process": [
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_start",
          "output": "week_start_time"
        },
        {
          "input1": "study_start",
          "operator": "+",
          "input2": "week_end",
          "output": "week_end_time"
        },
        {
          "input1": "current_time",
          "operator": ">=",
          "input2": "week_start_time",
          "output": "valid_week_start"
        },
        {
          "input1": "current_time",
          "operator": "<=",
          "input2": "week_end_time",
          "output": "valid_week_end"
        },
        {
          "input1": "valid_week_start",
          "operator": "count",
          "output": "is_valid_week_start"
        },
        {
          "input1": "valid_week_end",
          "operator": "count",
          "output": "is_valid_week_end"
        },
        {
          "input1": "is_valid_week_start",
          "operator": "+",
          "input2": "is_valid_week_end",
          "output": "is_valid"
        },
        {
          "input1": "is_valid",
          "operator": "==",
          "input2": "two",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "block1_4hour_stress_ema",
      "type": "__BLOCK__",
      "title": "Valid for Stress EMA in Block 1 (4 hour) from day start",
      "summary": "Valid for Stress EMA in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMA,STRESS,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "block1_4hour_random_ema",
      "type": "__BLOCK__",
      "title": "Valid for Random EMA in Block 1 (4 hour) from day start",
      "summary": "Valid for Random EMA in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMA,RANDOM,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "block1_4hour_low_stress_emi",
      "type": "__BLOCK__",
      "title": "Valid for Low Stress EMI in Block 1 (4 hour) from day start",
      "summary": "Valid for Low Stress EMI in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMI,LOW_STRESS,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "block1_4hour_high_stress_emi",
      "type": "__BLOCK__",
      "title": "Valid for High Stress EMI in Block 1 (4 hour) from day start",
      "summary": "Valid for High Stress EMI in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMI,HIGH_STRESS,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "block1_4hour_smoking_emi",
      "type": "__BLOCK__",
      "title": "Valid for Smoking EMI in Block 1 (4 hour) from day start",
      "summary": "Valid for Smoking EMI in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMI,SMOKING,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "block1_4hour_nonsmoking_emi",
      "type": "__BLOCK__",
      "title": "Valid for Not Smoking EMI in Block 1 (4 hour) from day start",
      "summary": "Valid for Not Smoking EMI in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMI,NOT_SMOKING,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "block1_4hour_smoking_ema",
      "type": "__BLOCK__",
      "title": "Valid for Smoking EMA in Block 1 (4 hour) from day start",
      "summary": "Valid for Smoking EMA in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMA,SMOKING,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "block1_4hour_stress_ema",
      "type": "__BLOCK__",
      "title": "Valid for Stress EMA in Block 1 (4 hour) from day start",
      "summary": "Valid for Stress EMA in Block 1 (4 hour) from day start",
      "condition": "now()>get_last_sample(DAY,START,null,null,null,null,null,null,0)+time(00:00:00) and now()<get_last_sample(DAY,START,null,null,null,null,null,null)+time(04:00:00) and count_sample(EMA,STRESS,null,null,null,null,null,null,get_last_sample(DAY,START,0)+time(00:00:00),get_last_sample(DAY,START)+time(04:00:00))<1"
    },
    {
      "id": "valid_study",
      "type": "__VALID_STUDY__",
      "title": "study_started",
      "summary": "This is a valid study",
      "input": [
        {
          "input": "study_start",
          "search_by_sample": {
            "source": {
              "type": "STUDY_START"
            },
            "sample_no": 1,
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "study_end",
          "search_by_sample": {
            "source": {
              "type": "STUDY_END"
            },
            "sample_no": 1,
            "not_found_default": "4000000000000",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "current_time",
          "search_by_value": "now()"
        }
      ],
      "process": [
        {
          "input1": "study_start",
          "operator": "<=",
          "input2": "current_time",
          "output": "ss_ct"
        },
        {
          "input1": "current_time",
          "operator": "<",
          "input2": "study_end",
          "output": "ct_se"
        },
        {
          "input1": "ss_ct",
          "operator": "&&",
          "input2": "ct_se",
          "output": "ss_ct && ct_se"
        },
        {
          "input1": "study_start",
          "operator": ">",
          "input2": "study_end",
          "output": "se_ss"
        },
        {
          "input1": "se_ss",
          "operator": "&&",
          "input2": "ss_ct",
          "output": "se_ss && ss_ct"
        },
        {
          "input1": "ss_ct && ct_se",
          "operator": "||",
          "input2": "se_ss && ss_ct",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "valid_day",
      "type": "__VALID_DAY__",
      "title": "valid_day",
      "summary": "This is valid day",
      "input": [
        {
          "input": "day_start",
          "search_by_sample": {
            "source": {
              "type": "DAY_START"
            },
            "sample_no": 1,
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "day_end",
          "search_by_sample": {
            "source": {
              "type": "DAY_END"
            },
            "sample_no": 1,
            "not_found_default": "4000000000000",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "current_time",
          "search_by_value": "now()"
        },
        {
          "input": "24_hour",
          "search_by_value": "time(24:00:00)"
        }
      ],
      "process": [
        {
          "input1": "day_start",
          "operator": "+",
          "input2": "24_hour",
          "output": "ds24"
        },
        {
          "input1": "day_start",
          "operator": "<=",
          "input2": "current_time",
          "output": "ds_ct"
        },
        {
          "input1": "current_time",
          "operator": "<",
          "input2": "day_end",
          "output": "ct_de"
        },
        {
          "input1": "current_time",
          "operator": "<",
          "input2": "ds24",
          "output": "ct_ds24"
        },
        {
          "input1": "ds_ct",
          "operator": "&&",
          "input2": "ct_de",
          "output": "ds_ct && ct_de"
        },
        {
          "input1": "ds_ct && ct_de",
          "operator": "&&",
          "input2": "ct_ds24",
          "output": "ds_ct && ct_de && ct_ds24"
        },
        {
          "input1": "day_start",
          "operator": ">",
          "input2": "day_end",
          "output": "de_ds"
        },
        {
          "input1": "de_ds",
          "operator": "&&",
          "input2": "ds_ct",
          "output": "de_ds && ds_ct"
        },
        {
          "input1": "de_ds && ds_ct",
          "operator": "&&",
          "input2": "ct_ds24",
          "output": "de_ds && ds_ct && ct_ds24"
        },
        {
          "input1": "ds_ct && ct_de && ct_ds24",
          "operator": "||",
          "input2": "de_ds && ds_ct && ct_ds24",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "high_stress_in_last_2_minutes",
      "type": "__STRESS__",
      "title": "High Stress detected",
      "summary": "High Stress detected",
      "input": [
        {
          "input": "high_stress",
          "search_by_time": {
            "source": {
              "type": "ORG_MD2K_CSTRESS_STRESS_EPISODE_CLASSIFICATION"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:02:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "stress_value",
          "search_by_value": "2"
        }
      ],
      "process": [
        {
          "input1": "high_stress",
          "input2": "stress_value",
          "operator": "==",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "smoking_in_last_2_minutes",
      "type": "__SMOKING__",
      "title": "Smoking detected in last 2 minutes",
      "summary": "Smoking detected in last 2 minutes",
      "input": [
        {
          "input": "smoking_event",
          "search_by_time": {
            "source": {
              "type": "PUFFMARKER_SMOKING_EPISODE"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:02:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "compare_with_0",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "smoking_event",
          "operator": "count",
          "output": "smoking_count"
        },
        {
          "input1": "smoking_count",
          "operator": "!=",
          "input2": "compare_with_0",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "smoking_emi_in_last_2_minutes",
      "type": "__EMI__",
      "title": "Smoking EMI is delivered in last 2 minutes",
      "summary": "Smoking EMI is delivered in last 2 minutes",
      "input": [
        {
          "input": "smoking_event",
          "search_by_time": {
            "source": {
              "id": "SMOKING",
              "type": "EMI"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:02:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "compare_with_0",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "smoking_event",
          "operator": "count",
          "output": "smoking_count"
        },
        {
          "input1": "smoking_count",
          "operator": "!=",
          "input2": "compare_with_0",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "nonsmoking_emi_in_last_2_minutes",
      "type": "__EMI__",
      "title": "Non Smoking EMI is delivered in last 2 minutes",
      "summary": "Non Smoking EMI is delivered in last 2 minutes",
      "input": [
        {
          "input": "smoking_event",
          "search_by_time": {
            "source": {
              "id": "NOT_SMOKING",
              "type": "EMI"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:02:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "compare_with_0",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "smoking_event",
          "operator": "count",
          "output": "smoking_count"
        },
        {
          "input1": "smoking_count",
          "operator": "!=",
          "input2": "compare_with_0",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "high_stress_emi_in_last_2_minutes",
      "type": "__EMI__",
      "title": "High Stress EMI is delivered in last 2 minutes",
      "summary": "High Stress EMI is delivered in last 2 minutes",
      "input": [
        {
          "input": "smoking_event",
          "search_by_time": {
            "source": {
              "id": "HIGH_STRESS",
              "type": "EMI"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:02:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "compare_with_0",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "smoking_event",
          "operator": "count",
          "output": "smoking_count"
        },
        {
          "input1": "smoking_count",
          "operator": "!=",
          "input2": "compare_with_0",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "low_stress_emi_in_last_2_minutes",
      "type": "__EMI__",
      "title": "Low Stress EMI is delivered in last 2 minutes",
      "summary": "Low Stress EMI is delivered in last 2 minutes",
      "input": [
        {
          "input": "smoking_event",
          "search_by_time": {
            "source": {
              "id": "LOW_STRESS",
              "type": "EMI"
            },
            "from": {
              "time": "NOW",
              "offset": "-00:02:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "compare_with_0",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "smoking_event",
          "operator": "count",
          "output": "smoking_count"
        },
        {
          "input1": "smoking_count",
          "operator": "!=",
          "input2": "compare_with_0",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "post_quit",
      "type": "__POST_QUIT__",
      "title": "Currently it is post quit day",
      "summary": "Currently it is post quit day",
      "input": [
        {
          "input": "post_quit",
          "search_by_sample": {
            "source": {
              "type": "POST_QUIT"
            },
            "sample_no": 1,
            "not_found_default": "false",
            "type": "SAMPLE",
            "data_type": "LONG"
          }
        },
        {
          "input": "current_time",
          "search_by_value": "now()"
        }
      ],
      "process": [
        {
          "input1": "post_quit",
          "operator": "<=",
          "input2": "current_time",
          "output": "output"
        }
      ],
      "output": "output"
    },
    {
      "id": "lapse",
      "type": "__LAPSE__",
      "title": "Smoking is detected from post quit day",
      "summary": "Smoking is detected from post quit day",
      "input": [
        {
          "input": "smoking_event",
          "search_by_time": {
            "source": {
              "type": "PUFFMARKER_SMOKING_EPISODE"
            },
            "from": {
              "search_by_sample": {
                "source": {
                  "type": "POST_QUIT"
                },
                "sample_no": 1,
                "not_found_default": "false",
                "type": "SAMPLE",
                "data_type": "LONG"
              },
              "offset": "00:00:00"
            },
            "to": {
              "time": "NOW"
            },
            "index": "0",
            "not_found_default": "true",
            "type": "SAMPLE",
            "data_type": "DOUBLE"
          }
        },
        {
          "input": "compare_with_0",
          "search_by_value": "0"
        }
      ],
      "process": [
        {
          "input1": "smoking_event",
          "operator": "count",
          "output": "smoking_count"
        },
        {
          "input1": "smoking_count",
          "operator": "!=",
          "input2": "compare_with_0",
          "output": "output"
        }
      ],
      "output": "output"
    }
  ]
}
